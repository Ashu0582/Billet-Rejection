function sortSheet() {
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName('Formatted');
  if (!sheet) {
    Logger.log("Sheet 'Formatted' not found");
    return;
  }

  var range = sheet.getRange('A1:ES5001');
  var sortSpecs = [
    {column: 13, ascending: true}, // Column M (13th column)
    {column: 1, ascending: true},  // Column A (1st column)
    {column: 14, ascending: true}, // Column N (14th column)
    {column: 15, ascending: true}, // Column O (15th column)
    {column: 16, ascending: true}, // Column P (16th column)
  ];

  range.sort(sortSpecs);

  // Sorting by cell color is not natively supported in Google Sheets via Apps Script.
  // We would need a custom function for that, which is not straightforward.

  // Delete columns M to P
  sheet.deleteColumns(13, 4);
}
